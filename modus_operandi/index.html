<!DOCTYPE html>
<html lang="">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>CSAW 2020 Qualifiers - modus_operandi - Bruno Anjos</title><meta name="Description" content="CSAW 2020 crypto challenge"><meta property="og:title" content="CSAW 2020 Qualifiers - modus_operandi" />
<meta property="og:description" content="CSAW 2020 crypto challenge" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://bruno-anjos.github.io/modus_operandi/" />
<meta property="article:published_time" content="2020-09-17T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-09-17T00:00:00+00:00" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="CSAW 2020 Qualifiers - modus_operandi"/>
<meta name="twitter:description" content="CSAW 2020 crypto challenge"/>
<meta name="application-name" content="Bruno Anjos Website">
<meta name="apple-mobile-web-app-title" content="Bruno Anjos Website"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://bruno-anjos.github.io/modus_operandi/" /><link rel="prev" href="https://bruno-anjos.github.io/utctf_random_ecb/" /><link rel="next" href="https://bruno-anjos.github.io/perfect_secrecy/" /><link rel="stylesheet" href="/lib/normalize/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "CSAW 2020 Qualifiers - modus_operandi",
        "inLanguage": "",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/bruno-anjos.github.io\/modus_operandi\/"
        },"genre": "posts","keywords": "ctf, crypto","wordcount":  747 ,
        "url": "https:\/\/bruno-anjos.github.io\/modus_operandi\/","datePublished": "2020-09-17T00:00:00+00:00","dateModified": "2020-09-17T00:00:00+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "Bruno Anjos"
            },"description": "CSAW 2020 crypto challenge"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Bruno Anjos">Bruno Anjos</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/categories/ctfs/"> CTFs </a><a class="menu-item" href="/tags/"> Tags </a><a class="menu-item" href="/about/"> About </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search here" id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Bruno Anjos">Bruno Anjos</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search here" id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/categories/ctfs/" title="">CTFs</a><a class="menu-item" href="/tags/" title="">Tags</a><a class="menu-item" href="/about/" title="">About</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><article class="page single"><h1 class="single-title animated flipInX">CSAW 2020 Qualifiers - modus_operandi</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://bruno-anjos.github.io" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>Bruno Anjos</a></span>&nbsp;<span class="post-category">included in <a href="/categories/ctfs/"><i class="far fa-folder fa-fw"></i>CTFs</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="17-09-2020">17-09-2020</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;747 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/posts/ctfs/csaw-qualifiers/csaw.png"
        data-srcset="/posts/ctfs/csaw-qualifiers/csaw.png, /posts/ctfs/csaw-qualifiers/csaw.png 1.5x, /posts/ctfs/csaw-qualifiers/csaw.png 2x"
        data-sizes="auto"
        alt="/posts/ctfs/csaw-qualifiers/csaw.png"
        title="CSAW 2020 crypto challenge" /></div><div class="content" id="content"><p>This is a crypto challenge from the CSAW 2020 CTF originally worth 150 points.</p>
<p>The challenge initially tells us to connect as such:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">$ nc crypto.chal.csaw.io 5001
Hello! For each plaintext you enter, find out if the block cipher used is ECB or CBC. Enter &#34;ECB&#34; or &#34;CBC&#34; to get the flag!
</code></pre></td></tr></table>
</div>
</div><p>We need to tell if the cipher being used to encode our plaintext is ECB or CBC. The big difference is that ECB, which stands for Electronic Code Book, always produces the same ciphertext for a given block.</p>
<p>The first thing to do is figure out the cipher block size. We can do this easily by entering only a letter and check out the size of the output.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">$ nc crypto.chal.csaw.io 5001
(INITIAL MESSAGE)
Enter plaintext:
a
Ciphertext is:  333b2ddd618ce8a23993af9e094d7769
ECB or CBC?
</code></pre></td></tr></table>
</div>
</div><p>We got <code>333b2ddd618ce8a23993af9e094d7769</code> as the ciphertext. Since this is hexadecimal representation, every character is 4 bits, thus making our block size 128 bits (4 * 32).</p>
<p>So to differentiate ECB from CBC we only need to send enough characters in the plaintext and then split our ciphertext every 32 characters (128 bits) and compare the first block of the ciphertext with the second. If these are equal then it&rsquo;s ECB, otherwise it&rsquo;s CBC.</p>
<p>I coded this into python and this is the result:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="ch">#!/usr/bin/python3</span>

<span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">remote</span><span class="p">(</span><span class="s1">&#39;crypto.chal.csaw.io&#39;</span><span class="p">,</span> <span class="mi">5001</span><span class="p">)</span>

<span class="n">modes_seq</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">solve</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">p</span>
    <span class="k">global</span> <span class="n">modes_seq</span>

    <span class="n">counter</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">plaintext</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&#34;a&#34;</span> <span class="o">*</span> <span class="mi">32</span><span class="p">)</span>
    
    <span class="c1"># receive initial message</span>
    <span class="n">p</span><span class="o">.</span><span class="n">recvlineS</span><span class="p">(</span><span class="n">keepends</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
    <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
        <span class="c1"># receive plaintext prompt</span>
        <span class="n">p</span><span class="o">.</span><span class="n">recvlineS</span><span class="p">(</span><span class="n">keepends</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c1"># send plaintext</span>
        <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="n">plaintext</span><span class="p">)</span>
        <span class="c1"># receive header from line with ciphertext</span>
        <span class="n">p</span><span class="o">.</span><span class="n">recvuntilS</span><span class="p">(</span><span class="s2">&#34;Ciphertext is:&#34;</span><span class="p">)</span>
        <span class="c1"># receive ciphertext</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">recvlineS</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="c1"># receive ECB or CBC prompt</span>
        <span class="n">p</span><span class="o">.</span><span class="n">recvlineS</span><span class="p">(</span><span class="n">keepends</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="c1"># check if it is ECB</span>
        <span class="n">is_ecb</span> <span class="o">=</span> <span class="n">check_equal_with_bs</span><span class="p">(</span><span class="n">cipher</span><span class="p">)</span>
        <span class="c1"># send cipher mode</span>
        <span class="k">if</span> <span class="n">is_ecb</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;ECB&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">p</span><span class="o">.</span><span class="n">sendline</span><span class="p">(</span><span class="s1">&#39;CBC&#39;</span><span class="p">)</span>
        <span class="k">print</span><span class="p">(</span><span class="n">f</span><span class="s2">&#34;cipher {counter}&#34;</span><span class="p">)</span>
        <span class="n">counter</span> <span class="o">*+=</span> <span class="mi">1</span>


<span class="k">def</span> <span class="nf">check_equal_with_bs</span><span class="p">(</span><span class="n">cipher</span><span class="p">):</span>
    <span class="n">bs</span> <span class="o">=</span> <span class="mi">32</span>
    <span class="n">b0</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[:</span><span class="n">bs</span><span class="p">]</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="n">cipher</span><span class="p">[</span><span class="n">bs</span><span class="p">:</span><span class="n">bs</span><span class="o">*</span><span class="mi">2</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">b0</span> <span class="o">==</span> <span class="n">b1</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>


<span class="n">solve</span><span class="p">()</span>
</code></pre></td></tr></table>
</div>
</div><p>We will send 32 characters since these make up 32 bytes (256 bits), to make our 2 blocks. When we run it we get:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">python3 solve.py
[+] Opening connection to crypto.chal.csaw.io on port 5001: Done
cipher 1
cipher 2
cipher 3
cipher 4
(...)
cipher 174
cipher 175
cipher 176
Traceback (most recent call last):
  ( EXCEPTION INFO )
EOFError
</code></pre></td></tr></table>
</div>
</div><p>It gave us an EOF after a while. After trying a couple of times we would understand this behaviour is recurrent.</p>
<p>After fiddling a bit (a lot actually) we can get to the result by checking out the cipher modes sequence.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-python" data-lang="python"><span class="c1"># got this from tweaking the previous script</span>
<span class="n">mode_seqs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span>
<span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">,</span>
<span class="s1">&#39;ECB&#39;</span><span class="p">,</span> <span class="s1">&#39;CBC&#39;</span><span class="p">]</span>
<span class="n">binary</span> <span class="o">=</span> <span class="s2">&#34;&#34;</span>

<span class="k">for</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">mode_seqs</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">mode</span> <span class="o">==</span> <span class="s2">&#34;ECB&#34;</span><span class="p">:</span>
        <span class="n">binary</span> <span class="o">+=</span> <span class="s2">&#34;0&#34;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">binary</span> <span class="o">+=</span> <span class="s2">&#34;1&#34;</span>

<span class="k">print</span><span class="p">(</span><span class="n">binary</span><span class="p">)</span>
</code></pre></td></tr></table>
</div>
</div><p>Our resulting binary is:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre class="chroma"><code class="language-fallback" data-lang="fallback">0110011001101100011000010110011101111011010001010100001101000010010111110111001
0011001010100000001101100011011000111100101011111011100110101010101100011011010
110010010001111101
</code></pre></td></tr></table>
</div>
</div><p>If we translate this to characters we get <code>flag{ECB_re@lly_sUck$}</code>. That&rsquo;s it.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 17-09-2020</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://bruno-anjos.github.io/modus_operandi/" data-title="CSAW 2020 Qualifiers - modus_operandi" data-hashtags="ctf,crypto"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://bruno-anjos.github.io/modus_operandi/" data-hashtag="ctf"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://bruno-anjos.github.io/modus_operandi/"><i class="fab fa-reddit fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/ctf/">ctf</a>,&nbsp;<a href="/tags/crypto/">crypto</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/utctf_random_ecb/" class="prev" rel="prev" title="UTCTF - Random ECB"><i class="fas fa-angle-left fa-fw"></i>UTCTF - Random ECB</a>
            <a href="/perfect_secrecy/" class="next" rel="next" title="CSAW 2020 Qualifiers - perfect_secrecy">CSAW 2020 Qualifiers - perfect_secrecy<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.74.3">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw"></i> LoveIt</a>
                </div><div class="footer-line"></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/katex/katex.min.css"><link rel="stylesheet" href="/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="/lib/autocomplete/autocomplete.min.js"></script><script type="text/javascript" src="/lib/lunr/lunr.min.js"></script><script type="text/javascript" src="/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="/lib/katex/katex.min.js"></script><script type="text/javascript" src="/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":-1},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"},"twemoji":true};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
